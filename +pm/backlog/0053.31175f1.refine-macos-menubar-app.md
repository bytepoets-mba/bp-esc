# Title: Refine macOS Menubar App UX & Functionality

## Description
Polish the macOS menubar implementation to match production quality:

- Window shows on initial start (not hidden)
- Refresh balance everytime window opens
- Remove dock App-icon completely
- Position window properly near menubar item (not top-left)
- Make window background fully transparent (it is not transparent at all)
- Add subtle drag handle at top of window for moving it around and remember position through restarts

## Priority
0053

## Acceptance Criteria

### Initial Launch
- [ ] App launches with window visible near menubar icon 
- [ ] Menubar icon visible immediately
- [ ] No dock App-icon (completely hidden)
- [ ] Balance auto-refreshes on launch

### Window Positioning
- [ ] Window positioned near menubar item (y = top, x = "variable" center of window = center of menubar icon)
- [ ] Window position remembered across restarts
- [ ] Window moves with menubar on screen changes/multi-monitor

### Visual Polish
- [ ] Window background 100% transparent (currently not transparent)
- [ ] White content card has proper drop shadow
- [ ] No window chrome/title bar visible

### Draggability
- [ ] Subtle drag handle (20px high bar at top of white card)
- [ ] Drag handle styled as gradient bar (light gray/blue)
- [ ] Window draggable via handle only (content non-draggable)
- [ ] Drag works smoothly (native macOS feel)

### Interactions
- [ ] Click menubar → hide window
- [ ] Click menubar → show window at saved position + refresh balance
- [ ] Window ✕ → hide (not quit)
- [ ] Menubar Quit → full exit
- [ ] All existing functionality preserved (balance, auto-refresh, etc.)

## Technical Implementation

### 1. Window Visibility on Launch
```json
// tauri.conf.json windows[0]
"visible": true
```

### 2. Hide Dock Icon Completely
**Option A**: Bundle macOS entitlements
```json
"bundle": {
  "macOS": {
    "infoPlist": {
      "LSUIElement": true
    }
  }
}
```

**Option B**: Rust activation policy
```rust
app.set_activation_policy(tauri::ActivationPolicy::Accessory);
```

### 3. Window Positioning & Persistence
```rust
// Save position on move/hide
window.on_window_event(|event| {
  if let WindowEvent::Resized(_) | WindowEvent::Moved(_) {
    // Save position to config file
  }
});

// Load position on show
let saved_pos = load_position();
window.set_position(tauri::Position::Custom(saved_pos));
```

**Initial position** (if no saved):
- x: screen_width - window_width - 20 (top-right near menubar)
- y: 30 (below menubar)

### 4. Transparent Background
Already implemented (`transparent: true`, `body { background: transparent }`)

### 5. Drag Handle
```css
/* style.css */
.drag-handle {
  height: 20px;
  background: linear-gradient(90deg, #f8fafc, #e2e8f0);
  border-radius: 8px 8px 0 0;
  cursor: grab;
  -webkit-app-region: drag;
  display: flex;
  align-items: center;
  justify-content: center;
  user-select: none;
}
```

Add to HTML: `<div class="drag-handle">⋮⋮⋮</div>` above container

## Dependencies
- None (uses existing Tauri APIs)

## Estimate
- Medium (2-3 hours)
  - Window visibility + auto-refresh: 20min
  - Dock hiding: 20min  
  - Positioning + persistence: 45min
  - Transparency fix: 20min
  - Drag handle: 30min
  - Testing: 45min

## Risks
- Dock hiding may require entitlements signing (test on clean macOS)
- Window positioning needs screen size detection

## Testing
- [ ] Launch → window visible near menubar, no dock
- [ ] Drag handle moves window
- [ ] Click menubar → hide/show at same position
- [ ] Multi-monitor → positions correctly
- [ ] All functionality preserved
