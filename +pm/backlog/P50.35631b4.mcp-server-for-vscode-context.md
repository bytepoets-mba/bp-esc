# MCP Server for VSCode/VSCodium Context

## Description

Add Model Context Protocol (MCP) server to BP-ESC that exposes VSCode/VSCodium editor context to AI assistants. Since BP-ESC already runs 24/7 as a menubar app, it's an ideal host for this functionality.

**Context:**
- AI assistants (OpenCode, Claude Desktop, etc.) can't see current file, selection, cursor position
- VSCode extensions have full API access to this data
- MCP is a standard protocol for exposing context to AI tools
- BP-ESC already has persistent client process + Tauri/Rust backend

**Approach:**
1. Small VSCodium extension watches editor state (`vscode.window.activeTextEditor`)
2. Sends updates to BP-ESC via local protocol (HTTP/stdio/IPC)
3. BP-ESC exposes MCP server endpoint
4. AI tools query: `editor://current-file`, `editor://selection`, etc.

**Benefits:**
- No separate daemon needed (BP-ESC already running)
- Works across any MCP-compatible AI tool
- Lightweight extension (just bridge code)
- Reuses BP-ESC's Rust backend capabilities

## Priority
P50 (Standard)

## Additional Requirements

### Architecture
```
VSCodium Extension → BP-ESC (Tauri) → MCP Protocol → OpenCode/Claude
```

### MCP Resources to Expose
- `editor://current-file` - Active file path + contents
- `editor://selection` - Selected text range
- `editor://cursor` - Cursor position
- `editor://tabs` - All open tabs

### Technical Tasks
- [ ] Research MCP server implementation in Rust (existing crates?)
- [ ] Design VSCodium extension ↔ BP-ESC communication protocol
- [ ] Build minimal VSCodium extension (TypeScript)
- [ ] Add MCP server endpoint to BP-ESC Tauri backend
- [ ] Test with OpenCode sidebar
- [ ] Document setup in README

### Open Questions
- What protocol for extension → BP-ESC? (HTTP localhost:port vs stdio vs Tauri IPC)
- Should extension be bundled or separate repo?
- Security: localhost-only, auth token needed?

### Acceptance Criteria
- [ ] VSCodium extension tracks active file/selection
- [ ] BP-ESC exposes working MCP server endpoint
- [ ] OpenCode can query current file via MCP
- [ ] Selection context flows to AI assistant
- [ ] Documented setup for end users

## Dependencies
- Tauri backend (already in place)
- VSCodium Extension API knowledge
- MCP protocol spec

## Estimate
~3-5 days (research + prototype + polish)
